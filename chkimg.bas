10MODE5
11VDU19,2,5,0,0,0
20*LOAD CHTAB1 3000
30N%=?&3000
31M%=&5800
32Q%=40
40FOR I%=1 TO N%
45J%=(I%-1)*2
50A%=&3000 + J%?&3001 + (J%?&3002) * 256
70W%=?A%
80H%=A%?1
90B%=W%*H%
94A%=A%+2
95K%=0
96IF M%+W%*8>=&5940 THEN M%=&5800:Q%=Q%+40
100FOR Y%=0 TO H%-1
105X%=0
110FOR D%=0 TO W%-1
115L%=Q% - Y%
120R%=L% DIV 8
130S%=L% MOD 8
135B%=A%?K%
140?(M% + R%*320 + S% + X%*8) = B%
145X%=X%+1
150K%=K%+1
160NEXT
170NEXT
180M%=M%+W%*8+8
190NEXT
200END
